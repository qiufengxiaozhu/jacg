<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zte.zudp.admin.mm.bigscreen.dao.ScreenDao">


    <!--趋势分析-->
<!--<select id="trendAnaly" resultType="com.zte.zudp.admin.mm.bigscreen.entity.Screen">-->
<select id="trendAnaly" resultType="java.util.Map">
select * from(
    select
        month,
        count(RECID) as num,
        DISTRICTNAME dest
    from
        (
        select
         DATE_FORMAT(NEWINSTTIME,'%Y-%m') as month,
         DISTRICTNAME,
         RECID
    from tocgcase

    where 1=1
       and DATE_FORMAT(NEWINSTTIME,'%Y')= '2018'
        ) t
    group by month,dest
    order by month) t2
    group by dest,month


</select>


    <select id="selectCase" resultType="com.zte.zudp.admin.mm.bigscreen.entity.Screen">

        SELECT
            RECID,
            EVENTDESC,
            MAINTYPENAME,
            DATE_FORMAT( NEWINSTTIME, "%Y-%m" ) NEWINSTTIME
        FROM
            tocgcase
        WHERE
            date( NEWINSTTIME ) >= DATE_SUB( CURDATE( ), INTERVAL 12 MONTH )
        ORDER BY
            NEWINSTTIME DESC
            LIMIT 3
    </select>

    <select id="countCase" resultType="com.zte.zudp.admin.mm.bigscreen.entity.Screen">

        SELECT
            DISTRICTNAME,
            COUNT( RECID ) as NUMBER
        FROM
            tocgcase
        WHERE
            date( NEWINSTTIME ) >= DATE_SUB( CURDATE( ), INTERVAL 12 MONTH )
        GROUP BY DISTRICTNAME

    </select>

</mapper>